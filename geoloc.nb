(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27608,        573]
NotebookOptionsPosition[     26849,        546]
NotebookOutlinePosition[     27238,        563]
CellTagsIndexPosition[     27195,        560]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Initialization", " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"Needs", " ", "[", "\"\<JLink`\>\"", "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Load", " ", "Java", " ", "functionality"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"JavaLink", "[", "]"}], " ", "===", " ", "Null"}], ",", " ", 
      RowBox[{
       RowBox[{"InstallJava", "[", "]"}], ";"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"LoadJavaClass", "[", "\"\<java.net.URLEncoder\>\"", "]"}], ";"}],
    "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Private", " ", "API", " ", "key", " ", "from", " ", "google"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
    "$key", " ", "=", " ", 
     "\"\<AIzaSyBufb92UiWaK5WRqZF_PeUloidrgn4OUw8\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"ToWebString", "[", "s_String", "]"}], " ", ":=", " ", 
    RowBox[{"URLEncoder`encode", "[", 
     RowBox[{"s", ",", " ", "\"\<UTF-8\>\""}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"iapi", "[", 
     RowBox[{"address_String", ",", " ", "key_String"}], "]"}], " ", ":=", 
    " ", "\n", " ", 
    RowBox[{
    "\"\<https://maps.googleapis.com/maps/api/geocode/json?address=\>\"", " ",
      "<>", " ", "\n", "  ", 
     RowBox[{"ToWebString", "[", "address", "]"}], " ", "<>", " ", 
     "\"\<&key=\>\"", " ", "<>", " ", "key"}]}], "\n", "  ", "\n", 
   RowBox[{
    RowBox[{"api", "[", "address_String", "]"}], " ", ":=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<lat\>\"", ",", " ", "\"\<lng\>\""}], "}"}], " ", "/.", 
         " ", 
         RowBox[{"(", 
          RowBox[{"\"\<location\>\"", " ", "/.", " ", 
           RowBox[{"(", 
            RowBox[{"\"\<geometry\>\"", " ", "/.", " ", 
             RowBox[{"(", 
              RowBox[{"\"\<results\>\"", " ", "/.", " ", "\n", "\t\t", 
               RowBox[{"ImportString", "[", 
                RowBox[{
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"iapi", "[", 
                    RowBox[{"address", ",", " ", "$key"}], "]"}], ",", " ", 
                   "\"\<String\>\""}], "]"}], ",", " ", "\"\<JSon\>\""}], 
                "]"}]}], ")"}]}], ")"}]}], ")"}]}]}], "}"}], ",", "\n", 
      "\t\t", 
      RowBox[{"Switch", "[", 
       RowBox[{"res", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"_Real", ",", " ", "_Real"}], "}"}], "}"}], ",", " ", 
        RowBox[{"First", "@", "res"}], ",", " ", "_", ",", " ", 
        RowBox[{"Missing", "[", "\"\<NotAvailable\>\"", "]"}]}], "]"}]}], 
     "\n", "\t", "]"}]}]}]}]], "Code",
 CellChangeTimes->{3.660827768651039*^9, 3.661170710231071*^9, 
  3.661184730920231*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Transfer", " ", "Command", " ", "line", " ", "args", " ", "to", " ", 
    "script", " ", "variable"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"args", " ", "=", " ", "$ScriptCommandLine"}], ";"}]}]], "Code",
 CellChangeTimes->{{3.660827768651039*^9, 3.660827792618745*^9}, 
   3.6608278543949413`*^9, {3.6608279687964163`*^9, 3.6608279824986153`*^9}, {
   3.660828680456506*^9, 3.6608286832299557`*^9}, {3.661080259588388*^9, 
   3.66108033864083*^9}, {3.66108041810981*^9, 3.661080524783681*^9}, {
   3.661080600462716*^9, 3.661080624845216*^9}, {3.661080677494485*^9, 
   3.661080683548801*^9}, {3.66108079318676*^9, 3.661080799776993*^9}, {
   3.6610808875040913`*^9, 3.6610809823814363`*^9}, {3.6610810176877193`*^9, 
   3.661081035073045*^9}, {3.66108115602114*^9, 3.6610811756211987`*^9}, {
   3.661081534896077*^9, 3.6610815373840218`*^9}, {3.661081569577647*^9, 
   3.661081579690755*^9}, {3.661081620589511*^9, 3.6610817522953663`*^9}, 
   3.6610823891633797`*^9, {3.6610824578005047`*^9, 3.661082467055643*^9}, {
   3.661167426007514*^9, 3.661167559918486*^9}, 3.661167600024145*^9, {
   3.6611699588889513`*^9, 3.6611699697917433`*^9}, {3.661170022218733*^9, 
   3.661170053116642*^9}, {3.661170230834057*^9, 3.661170275827312*^9}, {
   3.661170351998899*^9, 3.661170411975416*^9}, {3.66117045027009*^9, 
   3.661170551416148*^9}, {3.661170585027267*^9, 3.661170601788315*^9}, {
   3.6611707161097727`*^9, 3.6611708260876217`*^9}, {3.6611709332575502`*^9, 
   3.661171049837042*^9}, {3.6611711045852127`*^9, 3.661171254814762*^9}, {
   3.66117133985745*^9, 3.661171358873023*^9}, {3.661171503680228*^9, 
   3.6611715704198427`*^9}, {3.6611716253903418`*^9, 3.661171732395974*^9}, {
   3.661171898576398*^9, 3.661171950726267*^9}, 3.6611725521350737`*^9, {
   3.6611726022584867`*^9, 3.661172624297398*^9}, {3.661172749833757*^9, 
   3.661172779142372*^9}, {3.661173395222938*^9, 3.66117342112707*^9}, {
   3.661173468100618*^9, 3.6611735644475203`*^9}, {3.661173629053959*^9, 
   3.661173632044285*^9}, {3.661173668047262*^9, 3.661173683609598*^9}, {
   3.6611738214640503`*^9, 3.661173832647017*^9}, {3.66117387822472*^9, 
   3.661173892391543*^9}, {3.661173938515712*^9, 3.661173965654921*^9}, {
   3.6611740065140247`*^9, 3.661174010898177*^9}, {3.661174049984157*^9, 
   3.661174060497306*^9}, 3.6611807829336987`*^9, {3.661180817213093*^9, 
   3.6611808206200323`*^9}, {3.661181171656229*^9, 3.66118117988211*^9}, {
   3.661181472599099*^9, 3.661181511158194*^9}, {3.661202875667858*^9, 
   3.66120288333825*^9}, {3.661270820927926*^9, 3.6612708533363867`*^9}, {
   3.661276054182507*^9, 3.661276057190267*^9}, {3.6612775709523*^9, 
   3.6612775732213507`*^9}, {3.6612776089523373`*^9, 3.661277611078595*^9}, {
   3.661277665593025*^9, 3.661277763323963*^9}, {3.6612777955414352`*^9, 
   3.661277893696583*^9}, {3.661426738563094*^9, 3.66142675792127*^9}, {
   3.661426802326746*^9, 3.661426854668378*^9}, {3.662139419003829*^9, 
   3.662139501555626*^9}, {3.662139864540224*^9, 3.662139883856215*^9}, {
   3.662139925290491*^9, 3.662139929228037*^9}, {3.662144029957322*^9, 
   3.662144034952236*^9}, {3.6622300496262007`*^9, 3.662230087825968*^9}, {
   3.662243845616407*^9, 3.6622439265176153`*^9}, {3.662244065415044*^9, 
   3.662244078479553*^9}, {3.662244753233041*^9, 3.662244758854917*^9}, {
   3.662244871180513*^9, 3.662244872644746*^9}, {3.662244905084116*^9, 
   3.662245131246252*^9}, {3.6622933659958277`*^9, 3.662293378879636*^9}, {
   3.662296792245185*^9, 3.662296798994483*^9}, {3.6622968879062243`*^9, 
   3.66229707923766*^9}, 3.662297146364224*^9, {3.662297198754154*^9, 
   3.662297208627428*^9}, 3.662297518182692*^9, {3.662314709987938*^9, 
   3.662314716035234*^9}, {3.662314783270442*^9, 3.662314797192129*^9}, {
   3.662314887767871*^9, 3.662314934822412*^9}, {3.66231496507926*^9, 
   3.662315062606286*^9}, {3.662315202582108*^9, 3.662315368249971*^9}, {
   3.662333228202051*^9, 3.6623333963872337`*^9}, {3.662333449239246*^9, 
   3.662333452448628*^9}, {3.662395266786022*^9, 3.662395290156114*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "If", " ", "$ScriptCommandLine", " ", "is", " ", "completely", " ", 
     "blank"}], ",", " ", 
    RowBox[{"the", " ", 
     RowBox[{"script", "/", "notebook"}], " ", "is", " ", "being", " ", 
     "debugged", " ", "in", " ", "Mathematica"}]}], " ", "*)"}], "\n", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "$ScriptCommandLine", "]"}], "==", "0"}], ",", 
    "\n", "\t", 
    RowBox[{
     RowBox[{"args", "=", 
      RowBox[{"{", "\"\<plotaddress\>\"", "}"}]}], ";"}], "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Set", " ", "up", " ", "a", " ", "debug", " ", "Command", " ", "Line"}], 
     " ", "*)"}], "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"args", ",", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
         "\"\<test/address1.csv\>\""}]}], "]"}], ";"}], " ", "*)"}], "\n", 
    "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"args", ",", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
         "\"\<test/address2.csv\>\""}]}], "]"}], ";"}], " ", "*)"}], "\n", 
    "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"args", ",", "\"\<colour={Blue,Green}\>\""}], "]"}], ";"}], 
     " ", "*)"}], "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"args", ",", "\"\<legend={Personal,Work}\>\""}], "]"}], ";"}], 
     " ", "*)"}], "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"args", ",", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
         "\"\<test/address.csv\>\""}]}], "]"}], ";"}], " ", "*)"}], "\n", ",",
     "\n", "\t", "Nothing"}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.660827768651039*^9, 3.660827792618745*^9}, 
   3.6608278543949413`*^9, {3.6608279687964163`*^9, 3.6608279824986153`*^9}, {
   3.660828680456506*^9, 3.6608286832299557`*^9}, {3.661080259588388*^9, 
   3.66108033864083*^9}, {3.66108041810981*^9, 3.661080524783681*^9}, {
   3.661080600462716*^9, 3.661080624845216*^9}, {3.661080677494485*^9, 
   3.661080683548801*^9}, {3.66108079318676*^9, 3.661080799776993*^9}, {
   3.6610808875040913`*^9, 3.6610809823814363`*^9}, {3.6610810176877193`*^9, 
   3.661081035073045*^9}, {3.66108115602114*^9, 3.6610811756211987`*^9}, {
   3.661081534896077*^9, 3.6610815373840218`*^9}, {3.661081569577647*^9, 
   3.661081579690755*^9}, {3.661081620589511*^9, 3.6610817522953663`*^9}, 
   3.6610823891633797`*^9, {3.6610824578005047`*^9, 3.661082467055643*^9}, {
   3.661167426007514*^9, 3.661167559918486*^9}, 3.661167600024145*^9, {
   3.6611699588889513`*^9, 3.6611699697917433`*^9}, {3.661170022218733*^9, 
   3.661170053116642*^9}, {3.661170230834057*^9, 3.661170275827312*^9}, {
   3.661170351998899*^9, 3.661170411975416*^9}, {3.66117045027009*^9, 
   3.661170551416148*^9}, {3.661170585027267*^9, 3.661170601788315*^9}, {
   3.6611707161097727`*^9, 3.6611708260876217`*^9}, {3.6611709332575502`*^9, 
   3.661171049837042*^9}, {3.6611711045852127`*^9, 3.661171254814762*^9}, {
   3.66117133985745*^9, 3.661171358873023*^9}, {3.661171503680228*^9, 
   3.6611715704198427`*^9}, {3.6611716253903418`*^9, 3.661171732395974*^9}, {
   3.661171898576398*^9, 3.661171950726267*^9}, 3.6611725521350737`*^9, {
   3.6611726022584867`*^9, 3.661172624297398*^9}, {3.661172749833757*^9, 
   3.661172779142372*^9}, {3.661173395222938*^9, 3.66117342112707*^9}, {
   3.661173468100618*^9, 3.6611735644475203`*^9}, {3.661173629053959*^9, 
   3.661173632044285*^9}, {3.661173668047262*^9, 3.661173683609598*^9}, {
   3.6611738214640503`*^9, 3.661173832647017*^9}, {3.66117387822472*^9, 
   3.661173892391543*^9}, {3.661173938515712*^9, 3.661173965654921*^9}, {
   3.6611740065140247`*^9, 3.661174010898177*^9}, {3.661174049984157*^9, 
   3.661174060497306*^9}, 3.6611807829336987`*^9, {3.661180817213093*^9, 
   3.6611808206200323`*^9}, {3.661181171656229*^9, 3.66118117988211*^9}, {
   3.661181472599099*^9, 3.661181511158194*^9}, {3.661202875667858*^9, 
   3.66120288333825*^9}, {3.661270820927926*^9, 3.6612708533363867`*^9}, {
   3.661276054182507*^9, 3.661276057190267*^9}, {3.6612775709523*^9, 
   3.6612775732213507`*^9}, {3.6612776089523373`*^9, 3.661277611078595*^9}, {
   3.661277665593025*^9, 3.661277763323963*^9}, {3.6612777955414352`*^9, 
   3.661277893696583*^9}, {3.661426738563094*^9, 3.66142675792127*^9}, {
   3.661426802326746*^9, 3.661426854668378*^9}, {3.662139419003829*^9, 
   3.662139501555626*^9}, {3.662139864540224*^9, 3.662139883856215*^9}, {
   3.662139925290491*^9, 3.662139929228037*^9}, {3.662144029957322*^9, 
   3.662144034952236*^9}, {3.6622300496262007`*^9, 3.662230087825968*^9}, {
   3.662243845616407*^9, 3.6622439265176153`*^9}, {3.662244065415044*^9, 
   3.662244078479553*^9}, {3.662244753233041*^9, 3.662244758854917*^9}, {
   3.662244871180513*^9, 3.662244872644746*^9}, {3.662244905084116*^9, 
   3.662245131246252*^9}, {3.6622933659958277`*^9, 3.662293378879636*^9}, {
   3.662296792245185*^9, 3.662296798994483*^9}, {3.6622968879062243`*^9, 
   3.66229707923766*^9}, 3.662297146364224*^9, {3.662297198754154*^9, 
   3.662297208627428*^9}, 3.662297518182692*^9, {3.662314709987938*^9, 
   3.662314716035234*^9}, {3.662314783270442*^9, 3.662314797192129*^9}, {
   3.662314887767871*^9, 3.662314934822412*^9}, {3.66231496507926*^9, 
   3.662315062606286*^9}, {3.662315202582108*^9, 3.662315368249971*^9}, {
   3.662333228202051*^9, 3.6623333963872337`*^9}, {3.662333449239246*^9, 
   3.662333452448628*^9}, {3.662333743087084*^9, 3.6623337582586117`*^9}, {
   3.662333857123258*^9, 3.6623339129771957`*^9}, {3.662390215493272*^9, 
   3.662390234283648*^9}, 3.6623903260767527`*^9, 3.662390366664364*^9, {
   3.6623904334035263`*^9, 3.66239045491549*^9}, 3.662390571355838*^9, {
   3.662390866109701*^9, 3.66239087183636*^9}, {3.6623911928457623`*^9, 
   3.662391200365222*^9}, {3.662391602680933*^9, 3.66239163652214*^9}, {
   3.662392687865858*^9, 3.662392702682827*^9}, {3.662393126808378*^9, 
   3.662393129273712*^9}, {3.6623934604916887`*^9, 3.662393461387683*^9}}],

Cell[BoxData["args"], "Input",
 CellChangeTimes->{{3.6623776512862864`*^9, 3.662377651825651*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "args", "]"}], "\[Equal]", "1"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<USAGE: geoloc file1 [file2...]\>\"", "]"}], 
     "\n", "\t", 
     RowBox[{"Exit", "[", "]"}]}], "\n", ",", "\n", "\t", "Nothing"}], "\n", 
   "]"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Parse", " ", "the", " ", "command", " ", "line"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"flist", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"flist", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"Rest", "[", "args", "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", "\"\<Command Line Parsed\>\"", "]"}]}], "Code",
 CellChangeTimes->{{3.660827768651039*^9, 3.660827792618745*^9}, 
   3.6608278543949413`*^9, {3.6608279687964163`*^9, 3.6608279824986153`*^9}, {
   3.660828680456506*^9, 3.6608286832299557`*^9}, {3.661080259588388*^9, 
   3.66108033864083*^9}, {3.66108041810981*^9, 3.661080524783681*^9}, {
   3.661080600462716*^9, 3.661080624845216*^9}, {3.661080677494485*^9, 
   3.661080683548801*^9}, {3.66108079318676*^9, 3.661080799776993*^9}, {
   3.6610808875040913`*^9, 3.6610809823814363`*^9}, {3.6610810176877193`*^9, 
   3.661081035073045*^9}, {3.66108115602114*^9, 3.6610811756211987`*^9}, {
   3.661081534896077*^9, 3.6610815373840218`*^9}, {3.661081569577647*^9, 
   3.661081579690755*^9}, {3.661081620589511*^9, 3.6610817522953663`*^9}, 
   3.6610823891633797`*^9, {3.6610824578005047`*^9, 3.661082467055643*^9}, {
   3.661167426007514*^9, 3.661167559918486*^9}, 3.661167600024145*^9, {
   3.6611699588889513`*^9, 3.6611699697917433`*^9}, {3.661170022218733*^9, 
   3.661170053116642*^9}, {3.661170230834057*^9, 3.661170275827312*^9}, {
   3.661170351998899*^9, 3.661170411975416*^9}, {3.66117045027009*^9, 
   3.661170551416148*^9}, {3.661170585027267*^9, 3.661170601788315*^9}, {
   3.6611707161097727`*^9, 3.6611708260876217`*^9}, {3.6611709332575502`*^9, 
   3.661171049837042*^9}, {3.6611711045852127`*^9, 3.661171254814762*^9}, {
   3.66117133985745*^9, 3.661171358873023*^9}, {3.661171503680228*^9, 
   3.6611715704198427`*^9}, {3.6611716253903418`*^9, 3.661171732395974*^9}, {
   3.661171898576398*^9, 3.661171950726267*^9}, 3.6611725521350737`*^9, {
   3.6611726022584867`*^9, 3.661172624297398*^9}, {3.661172749833757*^9, 
   3.661172779142372*^9}, {3.661173395222938*^9, 3.66117342112707*^9}, {
   3.661173468100618*^9, 3.6611735644475203`*^9}, {3.661173629053959*^9, 
   3.661173632044285*^9}, {3.661173668047262*^9, 3.661173683609598*^9}, {
   3.6611738214640503`*^9, 3.661173832647017*^9}, {3.66117387822472*^9, 
   3.661173892391543*^9}, {3.661173938515712*^9, 3.661173965654921*^9}, {
   3.6611740065140247`*^9, 3.661174010898177*^9}, {3.661174049984157*^9, 
   3.661174060497306*^9}, 3.6611807829336987`*^9, {3.661180817213093*^9, 
   3.6611808206200323`*^9}, {3.661181171656229*^9, 3.66118117988211*^9}, {
   3.661181472599099*^9, 3.661181511158194*^9}, {3.661202875667858*^9, 
   3.66120288333825*^9}, {3.661270820927926*^9, 3.6612708533363867`*^9}, {
   3.661276054182507*^9, 3.661276057190267*^9}, {3.6612775709523*^9, 
   3.6612775732213507`*^9}, {3.6612776089523373`*^9, 3.661277611078595*^9}, {
   3.661277665593025*^9, 3.661277763323963*^9}, {3.6612777955414352`*^9, 
   3.661277893696583*^9}, {3.661426738563094*^9, 3.66142675792127*^9}, {
   3.661426802326746*^9, 3.661426854668378*^9}, {3.662139419003829*^9, 
   3.662139501555626*^9}, {3.662139864540224*^9, 3.662139883856215*^9}, {
   3.662139925290491*^9, 3.662139929228037*^9}, {3.662144029957322*^9, 
   3.662144034952236*^9}, {3.6622300496262007`*^9, 3.662230087825968*^9}, {
   3.662243845616407*^9, 3.6622439265176153`*^9}, {3.662244065415044*^9, 
   3.662244078479553*^9}, {3.662244753233041*^9, 3.662244758854917*^9}, {
   3.662244871180513*^9, 3.662244872644746*^9}, {3.662244905084116*^9, 
   3.662245131246252*^9}, {3.6622933659958277`*^9, 3.662293378879636*^9}, {
   3.662296792245185*^9, 3.662296798994483*^9}, {3.6622968879062243`*^9, 
   3.66229707923766*^9}, 3.662297146364224*^9, {3.6622973636409597`*^9, 
   3.662297394304502*^9}, {3.662297487082831*^9, 3.662297495700548*^9}, 
   3.6622975345287113`*^9, {3.662393384146639*^9, 3.662393392445121*^9}, {
   3.662393454387513*^9, 3.662393455443563*^9}, {3.662394185472139*^9, 
   3.6623942731974907`*^9}, {3.662395225936572*^9, 3.662395239850568*^9}, {
   3.662395296948429*^9, 3.662395322260257*^9}, 3.662395366095542*^9, {
   3.662395397073161*^9, 3.6623954484353037`*^9}}],

Cell[BoxData["flist"], "Input",
 CellChangeTimes->{{3.6612735056882963`*^9, 3.661273507150652*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "function", " ", "to", " ", "read", " ", "input", " ", 
    "addresses"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"readaddr", "[", "ifile_", "]"}], " ", ":=", " ", "\n", 
    RowBox[{"Switch", "[", 
     RowBox[{
      RowBox[{"FileExtension", "[", "ifile", "]"}], ",", "\n", "\t", 
      "\"\<csv\>\"", ",", 
      RowBox[{"Import", "[", "ifile", "]"}], ",", "\n", "\t", "\"\<xls\>\"", 
      ",", 
      RowBox[{"Import", "[", 
       RowBox[{"ifile", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<data\>\"", ",", "1"}], "}"}]}], "]"}], ",", "\n", "\t", 
      "\"\<xlsx\>\"", ",", 
      RowBox[{"Import", "[", 
       RowBox[{"ifile", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<data\>\"", ",", "1"}], "}"}]}], "]"}], ",", "\n", "\t", 
      "_", ",", "Nothing"}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Read", " ", "files", " ", "from", " ", "the", " ", "command", " ", 
     "line"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"tblInput", " ", "=", " ", 
     RowBox[{"readaddr", " ", "/@", " ", "flist"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.661180941084029*^9, 3.661180989012905*^9}, {
   3.661261155776153*^9, 3.661261254656642*^9}, {3.661273718907856*^9, 
   3.6612737699482803`*^9}, {3.6612742613284187`*^9, 3.661274338578671*^9}, {
   3.66127591037998*^9, 3.6612759454835167`*^9}, {3.6612759858296013`*^9, 
   3.661276043437615*^9}, 3.661276285600128*^9, {3.66142783452355*^9, 
   3.661427839003559*^9}, {3.6622306362691793`*^9, 3.66223063781308*^9}, {
   3.662293387711464*^9, 3.6622933998076973`*^9}, {3.662313421284144*^9, 
   3.662313450847703*^9}, {3.6623134975903*^9, 3.6623136476475563`*^9}, {
   3.6623137205425253`*^9, 3.662313785638163*^9}, {3.662314460599231*^9, 
   3.662314473870439*^9}, {3.6623154310977783`*^9, 3.6623155528506613`*^9}, {
   3.662333994103444*^9, 3.662334064264983*^9}, {3.662334147948574*^9, 
   3.662334289592185*^9}, {3.662380537883997*^9, 3.662380595431275*^9}, {
   3.662381053324932*^9, 3.662381066731118*^9}, {3.662393414930859*^9, 
   3.6623934223139143`*^9}, {3.6623938271021423`*^9, 3.662393828195018*^9}}],

Cell[BoxData["tblInput"], "Input",
 CellChangeTimes->{{3.6612743584338007`*^9, 3.661274362241043*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{"tblInput", ",", "$Failed"}], "]"}], ",", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{
     "Print", "[", "\"\<One or more files specified do not exist\>\"", "]"}], 
     ";", "\n", "\t", 
     RowBox[{"Exit", "[", "1", "]"}]}], "\n", ",", "\n", "\t", 
    RowBox[{"Print", "[", "\"\<Input files Read\>\"", "]"}]}], "\n", "]"}], 
  "\n"}]], "Code",
 CellChangeTimes->{{3.662390828289291*^9, 3.6623908436744967`*^9}, {
  3.662390966512597*^9, 3.662391050877523*^9}, {3.662391122086591*^9, 
  3.662391128675333*^9}, {3.662391425364923*^9, 3.662391427258843*^9}, {
  3.6623934298205233`*^9, 3.662393441411378*^9}, {3.66239383303333*^9, 
  3.662393834954504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"For", " ", "each", " ", "file", " ", "information"}], ",", " ", 
    RowBox[{
    "test", " ", "for", " ", "a", " ", "7", " ", "column", " ", "array"}]}], 
   " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"includes", " ", "some", " ", "GeoPos", " ", "Info"}], " ", "*)"}],
   "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Add", " ", "empty", " ", "columns", " ", "to", " ", "arrays", " ", 
    "which", " ", "are", " ", "address", " ", "only"}], " ", "*)"}]}]], "Code",\

 CellChangeTimes->{{3.6623956163827353`*^9, 3.662395760685731*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Define", " ", "Function", " ", "to", " ", "geolocate", " ", "adress", " ",
     "list"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"geoloc", "[", "input_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "colAddresses", ",", " ", "colLocations", ",", " ", "withpos", ",", 
        " ", "nopos", ",", " ", "tmp"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "seperate", " ", "the", " ", "list", " ", "into", " ", "tables", " ", 
        "of", " ", "rows", " ", "with", " ", "geoposition", " ", "and", " ", 
        "those", " ", "without"}], " ", "*)"}], "\n", "\t", "\n", "\n", "\t", 
      
      RowBox[{"(*", " ", 
       RowBox[{
       "Merge", " ", "address", " ", "components", " ", "into", " ", "a", " ",
         "single", " ", "string"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"colAddresses", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"Riffle", "[", 
            RowBox[{"#", ",", " ", "\"\< \>\""}], "]"}], "]"}], " ", "&"}], 
         " ", "/@", " ", "input"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Geolocate", " ", "the", " ", "address", " ", "on", " ", "Google"}], 
        " ", "*)"}], "\n", "\t", 
       RowBox[{"colLocations", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"api", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
         "colAddresses"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "flip", " ", "the", " ", "table", " ", "to", " ", "add", " ", "the", 
         " ", "latitude", " ", "and", " ", "longitude", " ", "as", " ", 
         "rows"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"tmp", " ", "=", " ", 
        RowBox[{"Transpose", "[", "input", "]"}]}], ";", "\n", "\t", 
       RowBox[{"tmp", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"tmp", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "@", "#"}], " ", "&"}], " ", "/@", " ", 
           "colLocations"}]}], "]"}]}], ";", " ", "\n", "\t", 
       RowBox[{"tmp", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"tmp", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "@", "#"}], " ", "&"}], " ", "/@", " ", 
           "colLocations"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Flip", " ", "the", " ", "table", " ", "back", " ", "to", " ", 
         "restore", " ", "columnar", " ", "format"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"tmp", " ", "=", " ", 
        RowBox[{"Transpose", "[", "tmp", "]"}]}], ";"}]}], "\n", "]"}]}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Geolocate", " ", "Addresses", " ", "from", " ", "Google", " ", "Maps"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"tblLoc", " ", "=", " ", 
     RowBox[{"geoloc", " ", "/@", " ", "tblInput"}]}], ";"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<Address lookup from Google Complete\>\"", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.660827768651039*^9, 3.660827792618745*^9}, {
  3.6608278543949413`*^9, 3.660827886417905*^9}, {3.661261278146105*^9, 
  3.661261280049438*^9}, {3.6612613318277063`*^9, 3.661261337835417*^9}, {
  3.661273904328816*^9, 3.6612739363623743`*^9}, {3.661274029861809*^9, 
  3.661274228565032*^9}, {3.661276326561861*^9, 3.661276375727179*^9}, {
  3.661276497576407*^9, 3.66127651050342*^9}, {3.661276775681926*^9, 
  3.6612768057690763`*^9}, {3.661702673756043*^9, 3.661702717011818*^9}, {
  3.6617028689681387`*^9, 3.661702872994285*^9}, {3.661709911769552*^9, 
  3.661709957264245*^9}, {3.6622934090399933`*^9, 3.662293433841061*^9}, {
  3.6623957839251413`*^9, 3.662395819905772*^9}, {3.662395975847254*^9, 
  3.662396050786154*^9}}],

Cell[BoxData["tblLoc"], "Input",
 CellChangeTimes->{{3.6623914449259367`*^9, 3.662391447306925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Save", " ", "Updated", " ", "Information"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"Print", "[", "\"\<Files updated\>\"", "]"}]}]], "Code",
 CellChangeTimes->{{3.6608309411916227`*^9, 3.660830958863791*^9}, {
  3.6612774842348127`*^9, 3.6612775045059633`*^9}, {3.66229350794672*^9, 
  3.662293526979381*^9}, {3.662395515717943*^9, 3.6623955736715813`*^9}}]
},
AutoGeneratedPackage->Automatic,
WindowSize->{808, 587},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2868, 71, 354, "Code"],
Cell[3429, 93, 4110, 59, 66, "Code"],
Cell[7542, 154, 6278, 114, 226, "Code"],
Cell[13823, 270, 98, 1, 28, "Input"],
Cell[13924, 273, 4631, 75, 208, "Code"],
Cell[18558, 350, 99, 1, 28, "Input"],
Cell[18660, 353, 2201, 45, 209, "Code"],
Cell[20864, 400, 102, 1, 28, "Input"],
Cell[20969, 403, 776, 18, 144, "Code"],
Cell[21748, 423, 622, 16, 98, "Code"],
Cell[22373, 441, 3934, 90, 352, "Code"],
Cell[26310, 533, 100, 1, 28, "Input"],
Cell[26413, 536, 432, 8, 82, "Code"]
}
]
*)

(* End of internal cache information *)
